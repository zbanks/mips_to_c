CRASHED

struct _mips2c_stack_EnRailgibud_Destroy {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_EnRailgibud_Draw {
    /* 0x00 */ char pad_0[0x38];
};                                                  /* size = 0x38 */

struct _mips2c_stack_EnRailgibud_Init {
    /* 0x00 */ char pad_0[0x34];
    /* 0x34 */ ColliderCylinder *sp34;              /* inferred */
    /* 0x38 */ char pad_38[0x8];
};                                                  /* size = 0x40 */

struct _mips2c_stack_EnRailgibud_Update {
    /* 0x00 */ char pad_0[0x20];
};                                                  /* size = 0x20 */

struct _mips2c_stack_func_80BA5400 {
    /* 0x00 */ char pad_0[0x70];
    /* 0x70 */ f32 sp70;                            /* inferred */
    /* 0x74 */ f32 sp74;                            /* inferred */
    /* 0x78 */ f32 sp78;                            /* inferred */
    /* 0x7C */ char pad_7C[0x4];
};                                                  /* size = 0x80 */

struct _mips2c_stack_func_80BA57A8 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA57F8 {
    /* 0x00 */ char pad_0[0x2C];
    /* 0x2C */ Vec3f *sp2C;                         /* inferred */
    /* 0x30 */ char pad_30[0x6];                    /* maybe part of sp2C[2]? */
    /* 0x36 */ s16 sp36;                            /* inferred */
    /* 0x38 */ char pad_38[0x4];                    /* maybe part of sp36[3]? */
    /* 0x3C */ f32 sp3C;                            /* inferred */
    /* 0x40 */ f32 sp40;                            /* inferred */
    /* 0x44 */ f32 sp44;                            /* inferred */
};                                                  /* size = 0x48 */

struct _mips2c_stack_func_80BA59F0 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA5A34 {
    /* 0x00 */ char pad_0[0x20];
};                                                  /* size = 0x20 */

struct _mips2c_stack_func_80BA5AF0 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA5B64 {
    /* 0x00 */ char pad_0[0x2C];
    /* 0x2C */ SkelAnime *sp2C;                     /* inferred */
    /* 0x30 */ char pad_30[0x4];
    /* 0x34 */ Actor *sp34;                         /* inferred */
};                                                  /* size = 0x38 */

struct _mips2c_stack_func_80BA5DBC {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA5E18 {
    /* 0x00 */ char pad_0[0x28];
    /* 0x28 */ SkelAnime *sp28;                     /* inferred */
    /* 0x2C */ char pad_2C[0x6];                    /* maybe part of sp28[2]? */
    /* 0x32 */ u16 sp32;                            /* inferred */
    /* 0x34 */ s32 sp34;                            /* inferred */
    /* 0x38 */ char pad_38[0x8];
};                                                  /* size = 0x40 */

struct _mips2c_stack_func_80BA6054 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA60B0 {
    /* 0x00 */ char pad_0[0x28];
};                                                  /* size = 0x28 */

struct _mips2c_stack_func_80BA6158 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA61A0 {
    /* 0x00 */ char pad_0[0x28];
};                                                  /* size = 0x28 */

struct _mips2c_stack_func_80BA6284 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA62D4 {
    /* 0x00 */ char pad_0[0x28];
    /* 0x28 */ PosRot *sp28;                        /* inferred */
    /* 0x2C */ char pad_2C[0x4];
};                                                  /* size = 0x30 */

struct _mips2c_stack_func_80BA6440 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA64AC {
    /* 0x00 */ char pad_0[0x34];
    /* 0x34 */ SkelAnime *sp34;                     /* inferred */
};                                                  /* size = 0x38 */

struct _mips2c_stack_func_80BA6584 {
    /* 0x00 */ char pad_0[0x20];
};                                                  /* size = 0x20 */

struct _mips2c_stack_func_80BA6604 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA6664 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA66C8 {
    /* 0x00 */ char pad_0[0x30];
};                                                  /* size = 0x30 */

struct _mips2c_stack_func_80BA6800 {
    /* 0x00 */ char pad_0[0x42];
    /* 0x42 */ s16 sp42;                            /* inferred */
    /* 0x44 */ f32 sp44;                            /* inferred */
    /* 0x48 */ char pad_48[0x4];
    /* 0x4C */ f32 sp4C;                            /* inferred */
    /* 0x50 */ ? sp50;                              /* inferred */
    /* 0x50 */ char pad_50[0x4];
    /* 0x54 */ f32 sp54;                            /* inferred */
    /* 0x58 */ char pad_58[0x4];
    /* 0x5C */ f32 sp5C;                            /* inferred */
    /* 0x60 */ char pad_60[0x4];
    /* 0x64 */ f32 sp64;                            /* inferred */
};                                                  /* size = 0x68 */

struct _mips2c_stack_func_80BA6974 {
    /* 0x00 */ char pad_0[0x74];
    /* 0x74 */ f32 sp74;                            /* inferred */
    /* 0x78 */ f32 sp78;                            /* inferred */
    /* 0x7C */ f32 sp7C;                            /* inferred */
    /* 0x80 */ ? sp80;                              /* inferred */
    /* 0x80 */ char pad_80[0xC];
    /* 0x8C */ f32 sp8C;                            /* inferred */
    /* 0x90 */ f32 sp90;                            /* inferred */
    /* 0x94 */ f32 sp94;                            /* inferred */
};                                                  /* size = 0x98 */

struct _mips2c_stack_func_80BA6B30 {};              /* size 0x0 */

struct _mips2c_stack_func_80BA6B9C {};              /* size 0x0 */

struct _mips2c_stack_func_80BA6D10 {
    /* 0x00 */ char pad_0[0x1C];
    /* 0x1C */ Actor *sp1C;                         /* inferred */
};                                                  /* size = 0x20 */

struct _mips2c_stack_func_80BA6DAC {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA6DF8 {
    /* 0x00 */ char pad_0[0x2C];
    /* 0x2C */ void *sp2C;                          /* inferred */
};                                                  /* size = 0x30 */

struct _mips2c_stack_func_80BA7088 {
    /* 0x00 */ char pad_0[0x38];
    /* 0x38 */ f32 sp38;                            /* inferred */
    /* 0x3C */ f32 sp3C;                            /* inferred */
    /* 0x40 */ f32 sp40;                            /* inferred */
    /* 0x44 */ char pad_44[0x4];
    /* 0x48 */ f32 sp48;                            /* inferred */
    /* 0x4C */ char pad_4C[0x4];
};                                                  /* size = 0x50 */

struct _mips2c_stack_func_80BA71E4 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA7234 {
    /* 0x00 */ char pad_0[0x28];
    /* 0x28 */ void (*sp28)(EnRailgibud *, GlobalContext *); /* inferred */
    /* 0x2C */ char pad_2C[0x4];
    /* 0x30 */ f32 sp30;                            /* inferred */
    /* 0x34 */ char pad_34[0x4];
    /* 0x38 */ f32 sp38;                            /* inferred */
    /* 0x3C */ void *sp3C;                          /* inferred */
};                                                  /* size = 0x40 */

struct _mips2c_stack_func_80BA7388 {
    /* 0x00 */ char pad_0[0x28];
};                                                  /* size = 0x28 */

struct _mips2c_stack_func_80BA7434 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA7578 {
    /* 0x00 */ char pad_0[0x20];
};                                                  /* size = 0x20 */

struct _mips2c_stack_func_80BA7878 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA789C {};              /* size 0x0 */

struct _mips2c_stack_func_80BA78F8 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

struct _mips2c_stack_func_80BA7B6C {
    /* 0x00 */ char pad_0[0x34];
    /* 0x34 */ ColliderCylinder *sp34;              /* inferred */
    /* 0x38 */ char pad_38[0x8];
};                                                  /* size = 0x40 */

struct _mips2c_stack_func_80BA7C78 {};              /* size 0x0 */

struct _mips2c_stack_func_80BA7CF0 {};              /* size 0x0 */

struct _mips2c_stack_func_80BA7D04 {};              /* size 0x0 */

struct _mips2c_stack_func_80BA7D14 {};              /* size 0x0 */

struct _mips2c_stack_func_80BA7D30 {
    /* 0x00 */ char pad_0[0x28];
};                                                  /* size = 0x28 */

struct _mips2c_stack_func_80BA7DC8 {
    /* 0x00 */ char pad_0[0x24];
    /* 0x24 */ SkelAnime *sp24;                     /* inferred */
    /* 0x28 */ char pad_28[0x4];
    /* 0x2C */ u32 sp2C;                            /* inferred */
};                                                  /* size = 0x30 */

struct _mips2c_stack_func_80BA8050 {
    /* 0x00 */ char pad_0[0x18];
};                                                  /* size = 0x18 */

void func_80BA5400(Actor *arg0, GlobalContext *arg1); /* static */
void func_80BA6440(Actor *arg0);                    /* static */
void func_80BA6584(Actor *arg0);                    /* static */
void func_80BA6800(EnRailgibud *arg0, GlobalContext *arg1, s32 arg2); /* static */
void func_80BA6B30(EnRailgibud *arg0);              /* static */
void func_80BA6DF8(Actor *arg0, GlobalContext *arg1); /* static */
void func_80BA71E4(Actor *arg0, GlobalContext *arg1); /* static */
void func_80BA7234(Actor *arg0, GlobalContext *arg1); /* static */
void func_80BA7388(EnRailgibud *arg0, GlobalContext *arg1); /* static */
void func_80BA7434(EnRailgibud *arg0, GlobalContext *arg1); /* static */
? func_80BA76C4(EnRailgibud *, GlobalContext *);    /* static */
s32 func_80BA789C(GlobalContext *arg0, s32 arg1, Gfx **arg2, Vec3f *arg3, Vec3s *arg4, Actor *arg5, Gfx **gfx); /* static */
void func_80BA78F8(GlobalContext *arg0, s32 arg1, Gfx **arg2, Vec3s *arg3, Actor *arg4, Gfx **gfx); /* static */
void func_80BA7D14(Actor *arg0);                    /* static */
? func_80BA7DC8(Actor *arg0, GlobalContext *arg1);  /* static */
extern FlexSkeletonHeader D_060053E8;
extern AnimationHeader D_0600ABE0;
extern FlexSkeletonHeader D_06010B88;
static ColliderCylinderInit D_80BA82A0 = {
    {0, 0, 9, 0x39, 0x10, 1},
    {1, {0, 0, 0}, {0xF7EFFFFF, 0, 0}, 0, 5, 1},
    {0x14, 0x46, 0, {0, 0, 0}},
};
static DamageTable D_80BA82CC = {
    {
        0,
        0xF2,
        0,
        0xF1,
        0xD0,
        0xD0,
        0xF2,
        0xD0,
        0xF1,
        0xF1,
        0xF1,
        0x21,
        0xD0,
        0x42,
        0xF1,
        0x10,
        0xD0,
        0xF2,
        0,
        0xC0,
        0,
        0xE0,
        0xF1,
        0xF1,
        0xF1,
        0,
        0,
        0,
        0,
        0,
        0,
        0xF1,
    },
};
static CollisionCheckInfoInit2 D_80BA82EC = {8, 0, 0, 0, 0xFF};
static s32 D_80BA82F8 = 0;
static InitChainEntry D_80BA82FC[3];                /* unable to generate initializer */
static ? D_80BA8308;                                /* unable to generate initializer */
static ? D_80BA8314;                                /* unable to generate initializer */
static ? D_80BA8320;                                /* unable to generate initializer */
static ActorAnimationEntry sAnimations[20] = {
    {(AnimationHeader *)0x6006678, 1.0f, 0.0f, 0.0f, 0, -8.0f},
    {(AnimationHeader *)0x6006B08, 0.5f, 0.0f, 0.0f, 3, 0.0f},
    {(AnimationHeader *)0x6006EEC, 1.0f, 0.0f, 0.0f, 2, -8.0f},
    {(AnimationHeader *)0x60073A4, 0.0f, 0.0f, 0.0f, 2, -8.0f},
    {(AnimationHeader *)0x6007BBC, 1.0f, 0.0f, 0.0f, 2, -8.0f},
    {(AnimationHeader *)0x60081A8, 1.0f, 0.0f, 0.0f, 0, -8.0f},
    {(AnimationHeader *)0x6009298, 1.0f, 0.0f, 0.0f, 2, -8.0f},
    {(AnimationHeader *)0x6009900, 1.0f, 0.0f, 0.0f, 2, -8.0f},
    {(AnimationHeader *)0x600A450, 1.0f, 0.0f, 0.0f, 2, -8.0f},
    {(AnimationHeader *)0x600ABE0, 1.0f, 0.0f, 0.0f, 0, -8.0f},
    {(AnimationHeader *)0x60113EC, 0.4f, 0.0f, 0.0f, 1, -8.0f},
    {(AnimationHeader *)0x601216C, 1.0f, 0.0f, 0.0f, 0, -8.0f},
    {(AnimationHeader *)0x60118D8, 1.0f, 0.0f, 0.0f, 0, -8.0f},
    {(AnimationHeader *)0x6011DB8, 1.0f, 0.0f, 0.0f, 0, -8.0f},
    {(AnimationHeader *)0x600A450, 3.0f, 0.0f, 0.0f, 2, -6.0f},
    {(AnimationHeader *)0x6005DF4, 1.0f, 0.0f, 0.0f, 2, -8.0f},
    {(AnimationHeader *)0x60061E4, 1.0f, 0.0f, 0.0f, 0, -8.0f},
    {(AnimationHeader *)0x6001600, 1.0f, 0.0f, 0.0f, 0, -8.0f},
    {(AnimationHeader *)0x60009C4, 1.0f, 0.0f, 0.0f, 2, -8.0f},
    {(AnimationHeader *)0x6000F1C, 1.0f, 0.0f, 0.0f, 0, -8.0f},
};

void func_80BA5400(Actor *arg0, GlobalContext *arg1) {
    f32 sp78;
    f32 sp74;
    f32 sp70;
    PosRot *temp_s0_3;
    f32 *temp_a1;
    s16 temp_v0_2;
    s32 temp_lo;
    s32 temp_s0_2;
    s32 temp_v1;
    s32 temp_v1_2;
    u8 *temp_s0;
    u8 temp_t2;
    void *temp_a2;
    void *temp_v0;
    s32 phi_s0;
    s32 phi_a3;

    temp_s0 = arg1->setupPathList + (((s32) (arg0->params & 0xFF00) >> 8) * 8);
    temp_v1 = D_80BA82F8;
    arg0->unk_294 = Lib_SegmentedToVirtual(temp_s0->unk_4);
    arg0->unk_298 = temp_v1;
    temp_t2 = temp_s0->unk_0;
    arg0->unk_29C = (s32) temp_t2;
    if (temp_v1 == 0) {
        phi_s0 = 1;
        if ((s32) temp_t2 >= 2) {
loop_3:
            D_80BA82F8 = D_80BA82F8 + 1;
            Actor_SpawnAsChild(arg1 + 0x1CA0, arg0, arg1, 0x235, 0.0f, 0.0f, 0.0f, (s16) 0, (s16) 0, (s16) 0, (s32) arg0->params);
            temp_s0_2 = phi_s0 + 1;
            phi_s0 = temp_s0_2;
            if (temp_s0_2 < arg0->unk_29C) {
                if (temp_s0_2 != 0xA) {
                    goto loop_3;
                }
            }
        }
        D_80BA82F8 = 0;
    }
    temp_v1_2 = arg0->unk_298;
    temp_a2 = arg0->unk_294;
    temp_v0 = temp_a2 + (temp_v1_2 * 6);
    arg0->world.pos.x = (f32) temp_v0->unk_0;
    arg0->world.pos.y = (f32) temp_v0->unk_2;
    arg0->world.pos.z = (f32) temp_v0->unk_4;
    phi_a3 = 0;
    if (temp_v1_2 < (arg0->unk_29C - 1)) {
        phi_a3 = temp_v1_2 + 1;
    }
    temp_lo = phi_a3 * 6;
    temp_s0_3 = &arg0->world;
    temp_a1 = &sp70;
    sp70 = (f32) *(temp_a2 + temp_lo);
    sp74 = (f32) (arg0->unk_294 + temp_lo)->unk_2;
    sp78 = (f32) (arg0->unk_294 + temp_lo)->unk_4;
    temp_v0_2 = Math_Vec3f_Yaw((Vec3f *) temp_s0_3, (Vec3f *) temp_a1);
    arg0->shape.rot.y = temp_v0_2;
    arg0->world.rot.y = temp_v0_2;
    arg0->home.pos.x = temp_s0_3->pos.x;
    arg0->home.pos.y = temp_s0_3->pos.y;
    arg0->home.pos.z = temp_s0_3->pos.z;
    arg0->unk_14 = (s32) temp_s0_3->unk_C;
    arg0->unk_18 = (s32) temp_s0_3->unk_10;
}

void EnRailgibud_Init(Actor *thisx, GlobalContext *globalCtx) {
    ColliderCylinder *sp34;
    ColliderCylinder *temp_a1;
    EnRailgibud *this = (EnRailgibud *) thisx;

    Actor_ProcessInitChain((Actor *) this, D_80BA82FC);
    this->actor.targetMode = 0;
    this->actor.hintId = 0x2D;
    this->actor.textId = 0;
    if ((this->actor.params & 0x80) != 0) {
        func_80BA7B6C(this, globalCtx);
        return;
    }
    func_80BA5400((Actor *) this, globalCtx);
    this->unk_3F2 = 0;
    this->unk_404 = 0;
    this->unk_3F8 = 0;
    this->unk_400 = 0;
    this->unk_3FA = 0;
    this->unk_402 = (s16) gSaveContext.time;
    if (this->actor.parent == 0) {
        this->unk_3EC = 1;
        this->unk_3EE = 1;
    }
    ActorShape_Init(&this->actor.shape, 0.0f, func_800B3FC0, 28.0f);
    SkelAnime_InitSV(globalCtx, &this->skelAnime, &D_060053E8, &D_0600ABE0, this->jointTable, this->morphTable, 0x1A);
    temp_a1 = &this->collider;
    sp34 = temp_a1;
    Collider_InitCylinder(globalCtx, temp_a1);
    Collider_SetCylinder(globalCtx, temp_a1, (Actor *) this, &D_80BA82A0);
    CollisionCheck_SetInfo2(&this->actor.colChkInfo, &D_80BA82CC, &D_80BA82EC);
    if ((gSaveContext.weekEventReg[14] & 4) != 0) {
        Actor_MarkForDeath((Actor *) this);
    }
    func_80BA57A8(this);
}

void EnRailgibud_Destroy(Actor *thisx, GlobalContext *globalCtx) {
    EnRailgibud *this = (EnRailgibud *) thisx;
    Collider_DestroyCylinder(globalCtx, &this->collider);
}

void func_80BA57A8(EnRailgibud *this) {
    EnRailgibud *temp_a3;

    temp_a3 = this;
    temp_a3->actor.speedXZ = 0.6f;
    this = temp_a3;
    func_800BDC5C(&temp_a3->skelAnime, (ActorAnimationEntry []) sAnimations, 0xA);
    this->actionFunc = func_80BA57F8;
}

void func_80BA57F8(EnRailgibud *this, GlobalContext *globalCtx) {
    f32 sp44;
    f32 sp40;
    f32 sp3C;
    s16 sp36;
    Vec3f *sp2C;
    Actor *temp_v1;
    s32 temp_v0;

    sp3C = (f32) this->unk_294[this->unk_298].x;
    sp40 = (f32) this->unk_294[this->unk_298].y;
    sp44 = (f32) this->unk_294[this->unk_298].z;
    if ((this->actor.xzDistToPlayer <= 100.0f) && (func_800B715C(globalCtx) != 0) && (Player_GetMask(globalCtx) != 0xC)) {
        this->actor.home.pos.x = this->actor.world.pos.x;
        this->actor.home.pos.y = this->actor.world.pos.y;
        this->actor.home.pos.z = this->actor.world.pos.z;
        this->unk_14 = (s32) this->unk_30;
        this->unk_18 = (s32) this->unk_34;
        func_80BA59F0(this);
    }
    Math_SmoothStepToS(&this->unk_3E2, 0, 1, 0x64, (s16) 0);
    Math_SmoothStepToS(&this->unk_3E8, 0, 1, 0x64, (s16) 0);
    temp_v1 = this->actor.parent;
    if (temp_v1 == 0) {
        if (this->unk_3EC != 0) {
            goto block_8;
        }
    } else if (temp_v1->unk_3EC != 0) {
block_8:
        sp2C = (Vec3f *) &this->actor.world;
        sp36 = Math_Vec3f_Yaw((Vec3f *) &this->actor.world, (Vec3f *) &sp3C);
        if (Math_Vec3f_DistXZ((Vec3f *) &this->actor.world, (Vec3f *) &sp3C) > 60.0f) {
            Math_SmoothStepToS(&this->actor.world.rot.y, sp36, 1, 0x190, (s16) 0xA);
            this->actor.shape.rot.y = this->actor.world.rot.y;
        } else {
            temp_v0 = this->unk_298;
            if (temp_v0 < (this->unk_29C - 1)) {
                this->unk_298 = temp_v0 + 1;
            } else {
                this->unk_298 = 0;
            }
        }
        Actor_SetVelocityAndMoveYRotationAndGravity((Actor *) this);
    }
}

void func_80BA59F0(EnRailgibud *this) {
    func_800BDC5C(&this->skelAnime, (ActorAnimationEntry []) sAnimations, 9);
    this->actionFunc = func_80BA5A34;
}

void func_80BA5A34(EnRailgibud *this, GlobalContext *globalCtx) {
    s16 temp_v1;
    s32 phi_v0;

    temp_v1 = this->actor.yawTowardsPlayer - (s16) (this->actor.shape.rot.y + this->unk_3E2 + this->unk_3E8);
    if ((s32) temp_v1 < 0) {
        phi_v0 = -(s32) temp_v1;
    } else {
        phi_v0 = (s32) temp_v1;
    }
    if (phi_v0 < 0x2008) {
        globalCtx->actorCtx.actorList[2].first->freezeTimer = 0x3C;
        func_8013ECE0(this->actor.xzDistToPlayer, 0xFFU, 0x14U, 0x96U);
        func_80123E90(globalCtx, (Actor *) this);
        Audio_PlayActorSound2((Actor *) this, 0x38E5U);
        func_80BA5AF0(this);
    }
    func_80BA6B9C(this, globalCtx);
}

void func_80BA5AF0(EnRailgibud *this) {
    SkelAnime *temp_a0;

    temp_a0 = &this->skelAnime;
    this = this;
    func_800BDC5C(temp_a0, (ActorAnimationEntry []) sAnimations, 0xA);
    this->actor.speedXZ = 0.4f;
    if (func_80BA5A34 == this->actionFunc) {
        this->unk_3F2 = 0x50;
    } else {
        this->unk_3F2 = 0x14;
    }
    this->actionFunc = func_80BA5B64;
}

void func_80BA5B64(EnRailgibud *this, GlobalContext *globalCtx) {
    Actor *sp34;
    SkelAnime *sp2C;
    SkelAnime *temp_a0;
    s16 temp_v0_2;
    s16 temp_v0_3;
    u8 temp_v0;

    sp34 = globalCtx->actorCtx.actorList[2].first;
    Math_ScaledStepToS(&this->actor.shape.rot.y, this->actor.yawTowardsPlayer, 0xFA);
    this->unk_30 = (unaligned s32) this->unk_BC;
    this->actor.world.rot.z = (s16) (u16) this->actor.shape.rot.z;
    Math_SmoothStepToS(&this->unk_3E2, 0, 1, 0x64, (s16) 0);
    Math_SmoothStepToS(&this->unk_3E8, 0, 1, 0x64, (s16) 0);
    if ((func_80BA6D10(this, globalCtx) != 0) && (Actor_IsActorFacingLink((Actor *) this, 0x38E3) != 0)) {
        if ((this->unk_3F4 == 0) && (this->actor.xzDistToPlayer <= 45.0f)) {
            sp34->freezeTimer = 0;
            temp_v0 = gSaveContext.playerForm;
            if ((temp_v0 == 1) || (temp_v0 == 3)) {
                func_80BA6054(this);
            } else if (globalCtx->grabPlayer(globalCtx, (Player *) sp34) != 0) {
                func_80BA5DBC(this);
            }
        } else {
            temp_v0_2 = this->unk_3F2;
            if (temp_v0_2 == 0) {
                sp34->freezeTimer = 0x28;
                this->unk_3F2 = 0x3C;
                func_8013ECE0(this->actor.xzDistToPlayer, 0xFFU, 0x14U, 0x96U);
                func_80123E90(globalCtx, (Actor *) this);
                Audio_PlayActorSound2((Actor *) this, 0x38E5U);
            } else {
                this->unk_3F2 = temp_v0_2 - 1;
            }
        }
    } else if ((this->unk_3F4 == 0) && (this->actor.xzDistToPlayer <= 45.0f)) {
        func_80BA6284(this);
    } else if (func_80BA6DAC(this, globalCtx) != 0) {
        func_80BA6284(this);
    }
    temp_v0_3 = this->unk_3F4;
    temp_a0 = &this->skelAnime;
    if ((s32) temp_v0_3 > 0) {
        this->unk_3F4 = temp_v0_3 - 1;
    }
    sp2C = temp_a0;
    if ((func_801378B8(temp_a0, 10.0f) != 0) || (func_801378B8(temp_a0, 22.0f) != 0)) {
        Audio_PlayActorSound2((Actor *) this, 0x382EU);
        return;
    }
    if ((globalCtx->gameplayFrames & 0x5F) == 0) {
        Audio_PlayActorSound2((Actor *) this, 0x38E4U);
    }
}

void func_80BA5DBC(EnRailgibud *this) {
    SkelAnime *temp_a0;

    temp_a0 = &this->skelAnime;
    this = this;
    func_800BDC5C(temp_a0, (ActorAnimationEntry []) sAnimations, 2);
    this->unk_3F2 = 0;
    this->actor.flags &= -2;
    this->unk_3F0 = 0;
    this->actionFunc = func_80BA5E18;
}

void func_80BA5E18(EnRailgibud *this, GlobalContext *globalCtx) {
    s32 sp34;
    u16 sp32;
    SkelAnime *sp28;
    Actor *temp_s1;
    SkelAnime *temp_a3;
    SkelAnime *temp_a3_2;
    s16 temp_v0;
    s16 temp_v0_2;
    s32 temp_v0_3;
    s32 temp_v1;

    temp_v0 = this->unk_3F0;
    temp_s1 = globalCtx->actorCtx.actorList[2].first;
    if (temp_v0 != 0) {
        if (temp_v0 != 1) {
            if (temp_v0 != 2) {
                return;
            }
            if (func_801378B8(&this->skelAnime, this->skelAnime.animFrameCount) != 0) {
                this->unk_3F4 = 0x28;
                this->actor.shape.yOffset = 0.0f;
                func_80BA5AF0(this);
                return;
            }
            Math_SmoothStepToF(&this->actor.shape.yOffset, 0.0f, 1.0f, 400.0f, 0.0f);
            /* Duplicate return node #23. Try simplifying control flow for better match */
            return;
        }
        temp_v0_2 = this->unk_3F2;
        if (temp_v0_2 == 0x14) {
            sp32 = temp_s1->unk_A68->unk_92 + 0x6805;
            globalCtx->damagePlayer(globalCtx, -8);
            func_800B8E58(temp_s1, sp32);
            func_8013ECE0(this->actor.xzDistToPlayer, 0xF0U, 1U, 0xCU);
            this->unk_3F2 = 0;
        } else {
            this->unk_3F2 = temp_v0_2 + 1;
        }
        temp_a3 = &this->skelAnime;
        sp28 = temp_a3;
        if (func_801378B8(temp_a3, 0.0f) != 0) {
            sp28 = temp_a3;
            Audio_PlayActorSound2((Actor *) this, 0x38E8U);
        }
        temp_v1 = temp_s1->unk_A70;
        temp_v0_3 = temp_v1 & 0x80;
        if ((temp_v0_3 == 0) || (temp_s1->unk_B62 != 0)) {
            if ((temp_s1->unk_B62 != 0) && (temp_v0_3 != 0)) {
                temp_s1->unk_A70 = (s32) (temp_v1 & ~0x80);
                temp_s1->unk_AE8 = 0x64;
            }
            func_800BDC5C(&this->skelAnime, (ActorAnimationEntry []) sAnimations, 1);
            this->unk_3F0 = 2;
            this->actor.flags |= 1;
            this->unk_3F2 = 0;
            return;
        }
        /* Duplicate return node #23. Try simplifying control flow for better match */
        return;
    }
    sp34 = func_80BA7088(this, globalCtx);
    temp_a3_2 = &this->skelAnime;
    sp28 = temp_a3_2;
    if ((func_801378B8(temp_a3_2, this->skelAnime.animFrameCount) != 0) && (sp34 == 1)) {
        this->unk_3F0 = 1;
        func_800BDC5C(temp_a3_2, (ActorAnimationEntry []) sAnimations, 0);
        return;
    }
    if ((temp_s1->unk_A70 & 0x80) == 0) {
        func_800BDC5C(temp_a3_2, (ActorAnimationEntry []) sAnimations, 1);
        this->unk_3F0 = 2;
        this->actor.flags |= 1;
        this->unk_3F2 = 0;
    }
}

void func_80BA6054(EnRailgibud *this) {
    func_800BDC5C(&this->skelAnime, (ActorAnimationEntry []) sAnimations, 7);
    Audio_PlayActorSound2((Actor *) this, 0x38E6U);
    this->actionFunc = func_80BA60B0;
    this->actor.speedXZ = -2.0f;
}

void func_80BA60B0(EnRailgibud *this, GlobalContext *globalCtx) {
    f32 temp_f0;

    temp_f0 = this->actor.speedXZ;
    if (temp_f0 < 0.0f) {
        this->actor.speedXZ = temp_f0 + 0.15f;
    }
    this->actor.world.rot.y = this->actor.yawTowardsPlayer;
    Math_SmoothStepToS(&this->unk_3E2, 0, 1, 0x12C, (s16) 0);
    Math_SmoothStepToS(&this->unk_3E8, 0, 1, 0x12C, (s16) 0);
    if (func_801378B8(&this->skelAnime, this->skelAnime.animFrameCount) != 0) {
        this->actor.world.rot.y = this->actor.shape.rot.y;
        func_80BA6158(this);
    }
}

void func_80BA6158(EnRailgibud *this) {
    EnRailgibud *temp_a3;

    temp_a3 = this;
    temp_a3->unk_3F2 = 0;
    this = temp_a3;
    func_800BDC5C(&temp_a3->skelAnime, (ActorAnimationEntry []) sAnimations, 0xA);
    this->actionFunc = func_80BA61A0;
}

void func_80BA61A0(EnRailgibud *this, GlobalContext *globalCtx) {
    f32 temp_f0;
    f32 temp_f6;
    s16 temp_v0;
    s16 temp_v0_2;

    Math_SmoothStepToS(&this->actor.world.rot.y, (s16) (this->actor.yawTowardsPlayer + 0x8000), 5, 0xDAC, (s16) 0xC8);
    temp_v0 = this->unk_3F2;
    this->actor.shape.rot.y = this->actor.world.rot.y;
    if ((s32) temp_v0 >= 0x3D) {
        func_80BA6284(this);
        this->unk_3F2 = 0;
        return;
    }
    temp_f0 = Math_SinS((s16) (temp_v0 * 0xFA0));
    temp_v0_2 = this->unk_3F2;
    temp_f6 = (f32) (0x3C - temp_v0_2);
    this->unk_3F2 = temp_v0_2 + 1;
    this->unk_3E2 = (s16) (s32) (temp_f0 * (9583.0f * (temp_f6 / 60.0f)));
}

void func_80BA6284(EnRailgibud *this) {
    SkelAnime *temp_a0;

    temp_a0 = &this->skelAnime;
    this = this;
    func_800BDC5C(temp_a0, (ActorAnimationEntry []) sAnimations, 0xA);
    this->actionFunc = func_80BA62D4;
    this->actor.speedXZ = 0.4f;
}

void func_80BA62D4(EnRailgibud *this, GlobalContext *globalCtx) {
    PosRot *sp28;
    PosRot *temp_a1;
    f32 temp_f0;
    u8 temp_v0;

    Math_SmoothStepToS(&this->unk_3E2, 0, 1, 0x64, (s16) 0);
    Math_SmoothStepToS(&this->unk_3E8, 0, 1, 0x64, (s16) 0);
    temp_a1 = &this->actor.home;
    sp28 = temp_a1;
    if (Actor_XZDistanceToPoint((Actor *) this, (Vec3f *) temp_a1) < 5.0f) {
        temp_f0 = this->actor.speedXZ;
        if (temp_f0 > 0.2f) {
            this->actor.speedXZ = temp_f0 - 0.2f;
        } else {
            this->actor.speedXZ = 0.0f;
        }
        Math_SmoothStepToS(&this->actor.shape.rot.y, this->actor.home.rot.y, 1, 0xC8, (s16) 0xA);
        this->actor.world.rot.y = this->actor.shape.rot.y;
        if (this->actor.home.rot.y == this->actor.world.rot.y) {
            func_80BA57A8(this);
        }
    } else {
        Math_ScaledStepToS(&this->actor.shape.rot.y, Actor_YawToPoint((Actor *) this, (Vec3f *) temp_a1), 0x1C2);
        this->unk_30 = (unaligned s32) this->unk_BC;
        this->actor.world.rot.z = (s16) (u16) this->actor.shape.rot.z;
    }
    if (func_80BA6D10(this, globalCtx) != 0) {
        temp_v0 = gSaveContext.playerForm;
        if ((temp_v0 != 1) && (temp_v0 != 3) && (Actor_IsActorFacingLink((Actor *) this, 0x38E3) != 0)) {
            func_80BA5AF0(this);
        }
    }
}

void func_80BA6440(Actor *arg0) {
    SkelAnime *temp_a0;

    temp_a0 = arg0 + 0x190;
    arg0 = arg0;
    func_800BDC5C(temp_a0, (ActorAnimationEntry []) sAnimations, 7);
    Audio_PlayActorSound2(arg0, 0x38E6U);
    arg0->unk_3F2 = 0;
    arg0->unk_3F4 = 0;
    arg0->unk_1D4 = func_80BA64AC;
    arg0->world.rot.y = arg0->yawTowardsPlayer;
    arg0->speedXZ = -2.0f;
}

void func_80BA64AC(EnRailgibud *this, GlobalContext *globalCtx) {
    SkelAnime *sp34;
    SkelAnime *temp_a0;
    f32 temp_f0;

    temp_f0 = this->actor.speedXZ;
    temp_a0 = &this->skelAnime;
    if (temp_f0 < 0.0f) {
        this->actor.speedXZ = temp_f0 + 0.15f;
    }
    sp34 = temp_a0;
    if (func_801378B8(temp_a0, this->skelAnime.animFrameCount) != 0) {
        this->unk_405 = -1;
        this->actor.world.rot.y = this->actor.shape.rot.y;
        if (((s32) this->unk_3F6 > 0) && (this->unk_404 == 0) && (this->unk_3F8 == 0)) {
            this->actor.hintId = 0x2A;
            SkelAnime_InitSV(globalCtx, sp34, &D_06010B88, NULL, this->jointTable, this->morphTable, 0x1A);
            this->unk_3F8 = 1;
        }
        func_80BA6284(this);
    }
}

void func_80BA6584(Actor *arg0) {
    arg0->unk_3F2 = 0xA;
    arg0->world.rot.y = arg0->shape.rot.y;
    if (arg0->unk_3F6 != 0) {
        func_800BCB70(arg0, 0, 0xC8, 0, (s16) 0x28);
    } else {
        func_800BCB70(arg0, 0, 0xC8, 0, (s16) 0x28);
    }
    arg0->unk_1D4 = func_80BA6604;
}

void func_80BA6604(EnRailgibud *this, GlobalContext *globalCtx) {
    s16 temp_v0;

    if (this->actor.colorFilterTimer == 0) {
        if (this->actor.colChkInfo.health == 0) {
            func_80BA6664(this);
        } else {
            func_80BA6440();
        }
    }
    temp_v0 = this->unk_3F2;
    if (temp_v0 != 0) {
        this->unk_3F2 = temp_v0 - 1;
    }
}

void func_80BA6664(EnRailgibud *this) {
    SkelAnime *temp_a0;

    temp_a0 = &this->skelAnime;
    this = this;
    func_800BDC5C(temp_a0, (ActorAnimationEntry []) sAnimations, 6);
    this->actor.flags &= -2;
    Audio_PlayActorSound2((Actor *) this, 0x38E7U);
    this->unk_3F2 = 0;
    this->actionFunc = func_80BA66C8;
}

void func_80BA66C8(EnRailgibud *this, GlobalContext *globalCtx) {
    u8 temp_t1;
    u8 temp_v0;

    if ((s32) this->unk_3F2 >= 0x12D) {
        temp_v0 = this->actor.shape.shadowAlpha;
        temp_t1 = temp_v0 - 5;
        if (temp_v0 == 0) {
            if (this->actor.parent != 0) {
                Actor_MarkForDeath((Actor *) this);
            } else {
                this->actor.draw = NULL;
                this->actor.update = func_80BA7878;
                this->actor.flags &= -2;
            }
        } else {
            this->actor.shape.shadowAlpha = temp_t1;
            if ((temp_t1 & 0xFF) < 5) {
                this->actor.shape.shadowAlpha = 0;
            }
        }
    } else {
        Math_SmoothStepToS(&this->unk_3E2, 0, 1, 0xFA, (s16) 0);
        Math_SmoothStepToS(&this->unk_3E8, 0, 1, 0xFA, (s16) 0);
        this->unk_3F2 += 1;
    }
    if ((this->unk_3F2 == 0x14) && ((s32) this->unk_3F6 > 0) && (this->unk_404 == 0) && (this->unk_3F8 == 0)) {
        SkelAnime_InitSV(globalCtx, &this->skelAnime, &D_06010B88, NULL, this->jointTable, this->morphTable, 0x1A);
        this->unk_3F8 = 1;
    }
}

void func_80BA6800(EnRailgibud *arg0, GlobalContext *arg1, s32 arg2) {
    f32 sp64;
    f32 sp5C;
    f32 sp54;
    ? sp50;
    f32 sp4C;
    f32 sp44;
    s16 sp42;
    s16 temp_v0;
    s32 temp_a0;

    sp5C.unk_0 = arg0->actor.world.pos.x;
    sp5C.unk_4 = (s32) arg0->actor.world.pos.y;
    sp5C.unk_8 = (s32) arg0->actor.world.pos.z;
    sp50.unk_0 = (s32) D_80BA8308.unk_0;
    sp50.unk_4 = (s32) D_80BA8308.unk_4;
    sp50.unk_8 = (s32) D_80BA8308.unk_8;
    sp44.unk_0 = D_80BA8314.unk_0;
    sp44.unk_4 = (s32) D_80BA8314.unk_4;
    sp44.unk_8 = (s32) D_80BA8314.unk_8;
    if ((arg1->gameplayFrames & arg2) == 0) {
        temp_v0 = Rand_Next();
        temp_a0 = temp_v0 << 0x10;
        sp42 = temp_v0;
        sp5C += 15.0f * Math_SinS((s16) (temp_a0 >> 0x10));
        sp64 += 15.0f * Math_CosS(sp42);
        sp44 = Rand_Centered();
        sp4C = Rand_Centered();
        sp54 += Rand_Centered() * 4.0f;
        EffectSsHahen_Spawn(arg1, (Vec3f *) &sp5C, (Vec3f *) &sp50, (Vec3f *) &sp44, (s16) 0, (s16) ((Rand_Next() & 7) + 0xA), (s16) -1, (s16) 0xA, NULL);
        func_80BA6974(arg1, (Vec3f *) &sp5C, 10.0f, 0xA, (s16) 0x96, (s16) 0);
    }
}

void func_80BA6974(GlobalContext *globalCtx, Vec3f *vec, f32 arg2, s32 arg3, s16 arg4, s16 arg5) {
    f32 sp94;
    f32 sp90;
    f32 sp8C;
    ? sp80;
    f32 sp7C;
    f32 sp78;
    f32 sp74;
    f32 *temp_s6;
    f32 *temp_s7;
    s32 temp_s0;
    s32 phi_s0;

    temp_s6 = &sp74;
    sp80.unk_0 = (s32) D_80BA8320.unk_0;
    sp80.unk_4 = (s32) D_80BA8320.unk_4;
    sp80.unk_8 = (s32) D_80BA8320.unk_8;
    temp_s7 = &sp8C;
    temp_s6->unk_0 = D_801D15B0.x;
    temp_s6->unk_4 = (f32) D_801D15B0.y;
    temp_s6->unk_8 = (f32) D_801D15B0.z;
    sp78 = 2.5f;
    phi_s0 = arg3;
    if (arg3 >= 0) {
        do {
            sp74 = (Rand_ZeroOne() - 0.5f) * arg2;
            sp7C = (Rand_ZeroOne() - 0.5f) * arg2;
            sp8C = vec->x + sp74;
            sp90 = ((Rand_ZeroOne() - 0.5f) * arg2) + vec->y;
            sp74 *= 0.5f;
            sp94 = vec->z + sp7C;
            sp7C *= 0.5f;
            func_800B1210(globalCtx, (Vec3f *) temp_s7, (Vec3f *) temp_s6, (Vec3f *) &sp80, (s16) ((s16) (s32) (Rand_ZeroOne() * (f32) arg4 * 0.2f) + arg4), (s16) (s32) arg5);
            temp_s0 = phi_s0 - 1;
            phi_s0 = temp_s0;
        } while (temp_s0 >= 0);
    }
}

void func_80BA6B30(EnRailgibud *arg0) {
    s16 temp_t6;
    s32 temp_v1;
    s32 temp_v1_2;
    void *temp_v0;

    temp_v0 = arg0->actor.parent;
    if (temp_v0 == 0) {
        temp_v1 = arg0->actionFunc;
        temp_t6 = arg0->unk_3EE;
        arg0->unk_3EE = 1;
        arg0->unk_3EC = temp_t6;
        if ((func_80BA57F8 != temp_v1) && (func_80BA66C8 != temp_v1)) {
            arg0->unk_3EE = 0;
            return;
        }
        /* Duplicate return node #7. Try simplifying control flow for better match */
        return;
    }
    temp_v1_2 = arg0->actionFunc;
    if ((func_80BA57F8 != temp_v1_2) && (func_80BA66C8 != temp_v1_2)) {
        temp_v0->unk_3EE = 0;
    }
}

void func_80BA6B9C(EnRailgibud *this, GlobalContext *globalCtx) {
    s16 temp_a1;
    s16 temp_a1_2;
    s16 temp_v0;
    s16 temp_v0_2;
    s16 temp_v0_3;
    s16 temp_v1;
    s32 phi_a2;
    s32 phi_a3;
    s32 phi_v0;
    s32 phi_a3_2;
    s32 phi_a3_3;
    s32 phi_a3_4;
    s16 phi_a3_5;
    s16 phi_a3_6;
    s16 phi_a3_7;
    s16 phi_a3_8;

    temp_a1 = this->unk_3E8;
    temp_v1 = this->actor.yawTowardsPlayer - this->actor.shape.rot.y;
    temp_v0 = temp_v1 - temp_a1;
    if ((s32) temp_v0 < -0x1F4) {
        phi_a2 = -0x1F4;
    } else {
        phi_a3_7 = temp_v0;
        if ((s32) temp_v0 >= 0x1F5) {
            phi_a3_7 = 0x1F4;
        }
        phi_a2 = (s32) phi_a3_7;
    }
    temp_v0_2 = temp_v0 - this->unk_3E2;
    if ((s32) temp_v0_2 < -0x1F4) {
        phi_v0 = -0x1F4;
    } else {
        phi_a3_8 = temp_v0_2;
        if ((s32) temp_v0_2 >= 0x1F5) {
            phi_a3_8 = 0x1F4;
        }
        phi_v0 = (s32) phi_a3_8;
    }
    if ((s32) temp_v1 >= 0) {
        phi_a3 = phi_a2;
        if (phi_a2 < 0) {
            phi_a3 = -phi_a2;
        }
        this->unk_3E8 = temp_a1 + phi_a3;
        if (phi_v0 < 0) {
            phi_a3_2 = -phi_v0;
        } else {
            phi_a3_2 = phi_v0;
        }
        this->unk_3E2 += phi_a3_2;
    } else {
        phi_a3_3 = phi_a2;
        if (phi_a2 < 0) {
            phi_a3_3 = -phi_a2;
        }
        this->unk_3E8 = temp_a1 - phi_a3_3;
        if (phi_v0 < 0) {
            phi_a3_4 = -phi_v0;
        } else {
            phi_a3_4 = phi_v0;
        }
        this->unk_3E2 -= phi_a3_4;
    }
    temp_a1_2 = this->unk_3E8;
    if ((s32) temp_a1_2 < -0x495F) {
        this->unk_3E8 = -0x495F;
    } else {
        phi_a3_5 = temp_a1_2;
        if ((s32) temp_a1_2 >= 0x4960) {
            phi_a3_5 = 0x495F;
        }
        this->unk_3E8 = phi_a3_5;
    }
    temp_v0_3 = this->unk_3E2;
    if ((s32) temp_v0_3 < -0x256F) {
        this->unk_3E2 = -0x256F;
        return;
    }
    phi_a3_6 = temp_v0_3;
    if ((s32) temp_v0_3 >= 0x2570) {
        phi_a3_6 = 0x256F;
    }
    this->unk_3E2 = phi_a3_6;
}

s32 func_80BA6D10(EnRailgibud *this, GlobalContext *globalCtx) {
    Actor *sp1C;
    s32 phi_v0;

    sp1C = globalCtx->actorCtx.actorList[2].first;
    if (Player_GetMask(globalCtx) == 0xC) {
        return 0;
    }
    phi_v0 = 0;
    if ((Actor_DistanceToPoint(sp1C, (Vec3f *) &this->actor.home) < 100.0f) && ((sp1C->unk_A6C & 0x2C6080) == 0) && ((sp1C->unk_A70 & 0x4080) == 0)) {
        phi_v0 = 1;
    }
    return phi_v0;
}

s32 func_80BA6DAC(EnRailgibud *this, GlobalContext *globalCtx) {
    s32 phi_v0;

    phi_v0 = 0;
    if (Actor_DistanceToPoint(globalCtx->actorCtx.actorList[2].first, (Vec3f *) &this->actor.home) >= 100.0f) {
        phi_v0 = 1;
    }
    return phi_v0;
}

void func_80BA6DF8(Actor *arg0, GlobalContext *arg1) {
    void *sp2C;
    s32 temp_v0;
    u8 temp_t3;
    void *temp_v1;

    temp_v1 = arg1->actorCtx.actorList[2].first;
    if ((arg0->unk_3FA != 1) && ((arg0->unk_155 & 2) != 0)) {
        if (func_80BA57F8 == arg0->unk_1D4) {
            arg0->home.pos.x = arg0->world.pos.x;
            arg0->home.pos.y = arg0->world.pos.y;
            arg0->home.pos.z = arg0->world.pos.z;
            arg0->unk_14 = (s32) arg0->unk_30;
            arg0->unk_18 = (s32) arg0->unk_34;
        }
        arg0->unk_155 = (u8) (arg0->unk_155 & 0xFFFD);
        sp2C = temp_v1;
        Actor_ApplyDamage(arg0);
        temp_t3 = arg0->colChkInfo.damageEffect;
        switch (temp_t3) {
        case 15:
            sp2C = temp_v1;
            func_800BCB70(arg0, 0x4000, 0xFF, 0, (s16) 8);
            if (temp_v1->unk_ADC != 0) {
                arg0->unk_405 = (s8) temp_v1->unk_ADD;
            }
            arg0->shape.yOffset = 0.0f;
            if (arg0->colChkInfo.health == 0) {
                func_80BA6664((EnRailgibud *) arg0);
                return;
            }
            func_80BA6440(arg0);
            return;
        case 14:
            if (arg0->unk_3F8 == 1) {
                arg0->colChkInfo.health = 0;
                arg0->shape.yOffset = 0.0f;
                func_80BA6664((EnRailgibud *) arg0);
                return;
            }
            /* Duplicate return node #28. Try simplifying control flow for better match */
            return;
        case 2:
            func_800BCB70(arg0, 0x4000, 0xFF, 0, (s16) 8);
            if (arg0->colChkInfo.health == 0) {
                func_80BA6664((EnRailgibud *) arg0);
            } else {
                func_80BA6440(arg0);
            }
            arg0->unk_404 = 0;
            arg0->unk_3F6 = 0xB4;
            arg0->unk_2A0 = 1.0f;
            return;
        case 4:
            func_800BCB70(arg0, 0x4000, 0xFF, 0, (s16) 8);
            if (arg0->colChkInfo.health == 0) {
                func_80BA6664((EnRailgibud *) arg0);
            } else {
                func_80BA6440(arg0);
            }
            arg0->unk_404 = 0x14;
            arg0->unk_3F6 = 0x3C;
            arg0->unk_2A0 = 1.0f;
            return;
        case 12:
            temp_v0 = arg0->unk_1D4;
            if ((func_80BA5E18 != temp_v0) && ((func_80BA6604 != temp_v0) || (arg0->unk_3F2 == 0))) {
                arg0->unk_404 = 0x1E;
                arg0->unk_3F6 = 0x28;
                arg0->unk_2A0 = 1.0f;
                func_80BA6584(arg0);
                return;
            }
            /* Duplicate return node #28. Try simplifying control flow for better match */
            return;
        case 1:
            if ((func_80BA6604 != arg0->unk_1D4) || (arg0->unk_3F2 == 0)) {
                func_80BA6584(arg0);
            }
            /* Duplicate return node #28. Try simplifying control flow for better match */
            return;
        }
    } else {
    default:
    }
}

s32 func_80BA7088(EnRailgibud *this, GlobalContext *globalCtx) {
    f32 sp48;
    f32 sp40;
    f32 sp3C;
    f32 sp38;
    Actor *temp_s0;
    s32 temp_s0_2;
    s32 temp_s0_3;
    s32 phi_v0;

    temp_s0 = globalCtx->actorCtx.actorList[2].first;
    sp38 = 0.0f;
    sp40.unk_0 = temp_s0->world.pos.x;
    sp40.unk_4 = (f32) temp_s0->world.pos.y;
    sp40.unk_8 = (f32) temp_s0->world.pos.z;
    sp40 -= 25.0f * Math_SinS(temp_s0->shape.rot.y);
    sp48 -= 25.0f * Math_CosS(temp_s0->shape.rot.y);
    sp3C = Math_Vec3f_StepTo((Vec3f *) &this->actor.world, (Vec3f *) &sp40, 10.0f);
    temp_s0_2 = Math_SmoothStepToS(&this->actor.shape.rot.y, temp_s0->shape.rot.y, 1, 0x1770, (s16) 0x64) << 0x10;
    this->actor.world.rot.y = this->actor.shape.rot.y;
    temp_s0_3 = temp_s0_2 >> 0x10;
    if (gSaveContext.playerForm == 4) {
        sp38 = Math_SmoothStepToF(&this->actor.shape.yOffset, -1500.0f, 1.0f, 150.0f, 0.0f);
    }
    if (sp3C == 0.0f) {
        phi_v0 = temp_s0_3;
        if (temp_s0_3 < 0) {
            phi_v0 = -temp_s0_3;
        }
        if ((phi_v0 < 0x64) && (sp38 == 0.0f)) {
            return 1;
        }
        goto block_8;
    }
block_8:
    return 0;
}

void func_80BA71E4(Actor *arg0, GlobalContext *arg1) {
    s32 temp_v0;

    temp_v0 = arg0->unk_1D4;
    if ((func_80BA5B64 == temp_v0) || (func_80BA62D4 == temp_v0) || (func_80BA64AC == temp_v0)) {
        Actor_SetVelocityAndMoveYRotationAndGravity(arg0);
    }
}

void func_80BA7234(Actor *arg0, GlobalContext *arg1) {
    void *sp3C;
    f32 sp38;
    f32 sp30;
    void (*sp28)(EnRailgibud *, GlobalContext *);
    void (*temp_v0)(EnRailgibud *, GlobalContext *);

    sp3C = arg1->actorCtx.actorList[2].first;
    if ((func_80BA5E18 == arg0->unk_1D4) && (arg0->unk_3F0 != 2)) {
        sp28 = func_80BA5E18;
        Actor_UpdateBgCheckInfo(arg1, arg0, 30.0f, 20.0f, 35.0f, 1U);
    } else {
        sp28 = func_80BA5E18;
        Actor_UpdateBgCheckInfo(arg1, arg0, 30.0f, 20.0f, 35.0f, 0x1DU);
    }
    if ((sp28 == arg0->unk_1D4) && (arg0->unk_3F0 == 0) && ((arg0->bgCheckFlags & 8) != 0)) {
        temp_v0 = sp3C + 0x24;
        sp30.unk_0 = sp3C->world.pos.x;
        sp30.unk_4 = (s32) temp_v0->unk_4;
        sp30.unk_8 = (s32) temp_v0->unk_8;
        sp28 = temp_v0;
        sp30 += 10.0f * Math_SinS(arg0->wallYaw);
        sp38 += 10.0f * Math_CosS(arg0->wallYaw);
        Math_Vec3f_StepTo((Vec3f *) sp28, (Vec3f *) &sp30, 5.0f);
    }
}

void func_80BA7388(EnRailgibud *arg0, GlobalContext *arg1) {
    s16 temp_v0;

    temp_v0 = arg0->unk_3F6;
    if ((s32) temp_v0 > 0) {
        arg0->unk_3F6 = temp_v0 - 1;
    }
    if ((s32) arg0->unk_3F6 < 0x14) {
        Math_SmoothStepToF(arg0 + 0x2A4, 0.0f, 0.5f, 0.03f, 0.0f);
        arg0->unk_2A0 = (f32) arg0->unk_3F6 * 0.05f;
        return;
    }
    Math_SmoothStepToF(arg0 + 0x2A4, 0.5f, 0.1f, 0.02f, 0.0f);
}

void func_80BA7434(EnRailgibud *arg0, GlobalContext *arg1) {
    EnRailgibud *temp_a0;
    s32 temp_v0;
    s32 temp_v0_2;
    u32 temp_t1;
    u32 temp_t4;

    temp_v0 = arg0->actionFunc;
    if ((func_80BA5E18 != temp_v0) && (func_80BA64AC != temp_v0) && (func_80BA60B0 != temp_v0) && (func_80BA61A0 != temp_v0) && (func_80BA66C8 != temp_v0)) {
        if ((arg0->actor.flags & 5) == 5) {
            arg0 = arg0;
            if (Player_GetMask(arg1) == 0xC) {
                temp_v0_2 = arg0->actionFunc;
                temp_t4 = arg0->actor.flags & ~5;
                arg0->actor.flags = temp_t4;
                arg0->actor.flags = temp_t4 | 9;
                arg0->actor.hintId = 0xFF;
                arg0->actor.textId = 0;
                if (func_80BA57F8 != temp_v0_2) {
                    temp_a0 = arg0;
                    if (func_80BA62D4 != temp_v0_2) {
                        arg0 = arg0;
                        func_80BA6284(temp_a0);
                    }
                }
            }
        } else {
            arg0 = arg0;
            if (Player_GetMask(arg1) != 0xC) {
                temp_t1 = arg0->actor.flags & ~9;
                arg0->actor.flags = temp_t1;
                arg0->actor.flags = temp_t1 | 5;
                if (arg0->unk_3F8 == 1) {
                    arg0->actor.hintId = 0x2A;
                } else {
                    arg0->actor.hintId = 0x2D;
                }
                arg0->actor.textId = 0;
            }
        }
        func_80BA7578(arg0, arg1);
    }
}

void func_80BA7578(EnRailgibud *this, GlobalContext *globalCtx) {
    GlobalContext *temp_a0_2;
    GlobalContext *temp_a1;
    MessageContext *temp_a0;
    u32 temp_v0;

    temp_a0 = &globalCtx->msgCtx;
    if ((this->unk_400 == 0) && (temp_a1 = globalCtx, (this->unk_3F8 == 0))) {
        globalCtx = globalCtx;
        if (func_800B84D0((Actor *) this, temp_a1) != 0) {
            this->unk_3FA = 1;
            func_801518B0(globalCtx, 0x13B2U, (Actor *) this);
            this->unk_400 = 0x13B2;
            Audio_PlayActorSound2((Actor *) this, 0x38E5U);
            this->actor.speedXZ = 0.0f;
            return;
        }
        if (((this->actor.flags & 9) == 9) && ((this->collider.base.acFlags & 2) == 0)) {
            func_800B8614((Actor *) this, globalCtx, 100.0f);
            return;
        }
        /* Duplicate return node #13. Try simplifying control flow for better match */
        return;
    }
    globalCtx = globalCtx;
    temp_v0 = func_80152498(temp_a0);
    switch (temp_v0) {
    case 5:
        temp_a0_2 = globalCtx;
        globalCtx = globalCtx;
        if (func_80147624(temp_a0_2) != 0) {
            func_801518B0(globalCtx, 0x13B3U, (Actor *) this);
            this->unk_400 = 0x13B3;
            return;
        }
    default:
        return;
    case 6:
        if (func_80147624(globalCtx) != 0) {
            this->unk_400 = 0;
            this->unk_3FA = 0;
            this->actor.speedXZ = 0.6f;
        }
        /* Duplicate return node #13. Try simplifying control flow for better match */
        return;
    }
}

/*
Failed to decompile function func_80BA76C4:

Label L80BA7770 refers to a delay slot; this is currently not supported.
Please modify the assembly to work around it (e.g. copy the instruction
to all jump sources and move the label, or add a nop to the delay slot).
*/

void EnRailgibud_Update(Actor *thisx, GlobalContext *globalCtx) {
    EnRailgibud *this = (EnRailgibud *) thisx;
    func_80BA6B30(this);
    func_80BA7434(this, globalCtx);
    func_80BA6DF8((Actor *) this, globalCtx);
    this->actionFunc(this, globalCtx);
    if (func_80BA6604 != this->actionFunc) {
        SkelAnime_FrameUpdateMatrix(&this->skelAnime);
    }
    func_80BA71E4((Actor *) this, globalCtx);
    func_80BA76C4(this, globalCtx);
    func_80BA7234((Actor *) this, globalCtx);
    func_80BA7388(this, globalCtx);
    this->actor.focus.pos.y = this->actor.world.pos.y;
    this->actor.focus.pos.x = this->actor.world.pos.x;
    this->actor.focus.pos.z = this->actor.world.pos.z;
    this->actor.focus.pos.y += 50.0f;
}

void func_80BA7878(Actor *thisx, GlobalContext *globalCtx) {
    func_80BA6B30();
}

s32 func_80BA789C(GlobalContext *arg0, s32 arg1, Gfx **arg2, Vec3f *arg3, Vec3s *arg4, Actor *arg5) {
    if (arg1 == 0xC) {
        arg4->y += arg5->unk_3E8;
    } else if (arg1 == 0x17) {
        arg4->y += arg5->unk_3E2;
    }
    return 0;
}

void func_80BA78F8(GlobalContext *arg0, s32 arg1, Gfx **arg2, Vec3s *arg3, Actor *arg4) {
    if ((arg4->unk_3F6 != 0) && ((arg1 == 3) || (arg1 == 4) || (arg1 == 6) || (arg1 == 8) || (arg1 == 9) || (arg1 == 0xB) || (arg1 == 0xE) || (arg1 == 0x10) || (arg1 == 0x11) || (arg1 == 0x12) || (arg1 == 0x14) || (arg1 == 0x15) || (arg1 == 0x16) || (arg1 == 0x18) || (arg1 == 0x19))) {
        SysMatrix_GetStateTranslation(arg4 + (arg4->unk_28C * 0xC) + 0x1D8);
        arg4->unk_28C = (s32) (arg4->unk_28C + 1);
    }
}

void EnRailgibud_Draw(Actor *thisx, GlobalContext *globalCtx) {
    Gfx *temp_v1;
    Gfx *temp_v1_2;
    Gfx *temp_v1_3;
    Gfx *temp_v1_4;
    GraphicsContext *temp_s1;
    EnRailgibud *this = (EnRailgibud *) thisx;

    temp_s1 = globalCtx->state.gfxCtx;
    this->unk_28C = 0;
    if (this->actor.shape.shadowAlpha == 0xFF) {
        func_8012C28C(globalCtx->state.gfxCtx);
        temp_v1 = temp_s1->polyOpa.p;
        temp_s1->polyOpa.p = temp_v1 + 8;
        temp_v1->words.w0 = 0xFB000000;
        temp_v1->words.w1 = (u32) this->actor.shape.shadowAlpha;
        temp_v1_2 = temp_s1->polyOpa.p;
        temp_s1->polyOpa.p = temp_v1_2 + 8;
        temp_v1_2->words.w1 = (u32) D_801AEFA0;
        temp_v1_2->words.w0 = 0xDB060020;
        temp_s1->polyOpa.p = SkelAnime_DrawSV2(globalCtx, this->skelAnime.skeleton, this->skelAnime.limbDrawTbl, (s32) this->skelAnime.dListCount, func_80BA789C, func_80BA78F8, (Actor *) this, temp_s1->polyOpa.p);
    } else {
        func_8012C2DC(globalCtx->state.gfxCtx);
        temp_v1_3 = temp_s1->polyXlu.p;
        temp_s1->polyXlu.p = temp_v1_3 + 8;
        temp_v1_3->words.w0 = 0xFB000000;
        temp_v1_3->words.w1 = (u32) this->actor.shape.shadowAlpha;
        temp_v1_4 = temp_s1->polyXlu.p;
        temp_s1->polyXlu.p = temp_v1_4 + 8;
        temp_v1_4->words.w1 = (u32) D_801AEF88;
        temp_v1_4->words.w0 = 0xDB060020;
        temp_s1->polyXlu.p = SkelAnime_DrawSV2(globalCtx, this->skelAnime.skeleton, this->skelAnime.limbDrawTbl, (s32) this->skelAnime.dListCount, func_80BA789C, func_80BA78F8, (Actor *) this, temp_s1->polyXlu.p);
    }
    if ((s32) this->unk_3F6 > 0) {
        func_800BE680(globalCtx, (Actor *) this, (Vec3f []) this->unk_1D8, 0xF, this->unk_2A4, 0.5f, this->unk_2A0, (u8) (s32) this->unk_404);
    }
}

void func_80BA7B6C(EnRailgibud *this, GlobalContext *globalCtx) {
    ColliderCylinder *sp34;
    ColliderCylinder *temp_a1;
    u32 temp_t8;

    func_80BA7C78(this);
    temp_t8 = this->actor.flags | 0x100000;
    this->actor.flags = temp_t8;
    this->unk_3FE = 0x63;
    this->actor.flags = temp_t8 | 0x10;
    ActorShape_Init(&this->actor.shape, 0.0f, func_800B3FC0, 28.0f);
    SkelAnime_InitSV(globalCtx, &this->skelAnime, &D_060053E8, &D_0600ABE0, this->jointTable, this->morphTable, 0x1A);
    temp_a1 = &this->collider;
    sp34 = temp_a1;
    Collider_InitCylinder(globalCtx, temp_a1);
    Collider_SetCylinder(globalCtx, temp_a1, (Actor *) this, &D_80BA82A0);
    CollisionCheck_SetInfo2(&this->actor.colChkInfo, &D_80BA82CC, &D_80BA82EC);
    if (gSaveContext.entranceIndex != 0x2090) {
        Actor_MarkForDeath((Actor *) this);
    }
    func_80BA7CF0(this);
    this->actor.update = func_80BA8050;
}

void func_80BA7C78(EnRailgibud *this) {
    s32 temp_t7;

    temp_t7 = this->actor.params & 0x7F;
    switch (temp_t7) {
    case 1:
        this->unk_3FC = 0x207;
        return;
    case 2:
        this->unk_3FC = 0x208;
        return;
    case 3:
        this->unk_3FC = 0x209;
        return;
    case 4:
        this->unk_3FC = 0x20A;
        return;
    case 5:
        this->unk_3FC = 0x20B;
        return;
    default:
        this->unk_3FC = 0x207;
        return;
    }
}

void func_80BA7CF0(EnRailgibud *this) {
    this->actionFunc = func_80BA7D04;
}

void func_80BA7D04(EnRailgibud *this, GlobalContext *globalCtx) {

}

void func_80BA7D14(Actor *arg0) {
    arg0->unk_3F2 = 0x1E;
    arg0->unk_1D4 = func_80BA7D30;
}

void func_80BA7D30(EnRailgibud *this, GlobalContext *globalCtx) {
    s16 temp_v0;

    temp_v0 = this->unk_3F2;
    if (temp_v0 != 0) {
        this->unk_3F2 = temp_v0 - 1;
        return;
    }
    if (Math_SmoothStepToF(&this->actor.shape.yOffset, -9500.0f, 0.5f, 200.0f, 10.0f) < 10.0f) {
        Actor_MarkForDeath((Actor *) this);
        return;
    }
    func_80BA6800(this, globalCtx, 0);
}

? func_80BA7DC8(Actor *arg0, GlobalContext *arg1) {
    u32 sp2C;
    SkelAnime *sp24;
    SkelAnime *temp_a0_2;
    s16 temp_v0_2;
    s32 temp_t7;
    u16 temp_a0;
    u16 temp_t1;
    u16 temp_v0_3;
    u32 temp_v0;
    void *temp_v1;

    if (func_800EE29C(arg1, (u32) arg0->unk_3FC) != 0) {
        temp_v0 = func_800EE200(arg1, (u32) arg0->unk_3FC);
        temp_t7 = temp_v0 * 4;
        sp2C = temp_v0;
        temp_v1 = arg1 + temp_t7;
        temp_a0 = *temp_v1->unk_1F4C;
        if (arg0->unk_3FE != temp_a0) {
            arg0->unk_3FE = temp_a0;
            temp_t1 = *temp_v1->unk_1F4C;
            switch (temp_t1) {
            case 1:
                arg0->unk_3F0 = 9;
                func_800BDC5C(arg0 + 0x190, (ActorAnimationEntry []) sAnimations, 9);
                break;
            case 2:
                arg0->unk_3F0 = 0xF;
                Audio_PlayActorSound2(arg0, 0x3A64U);
                func_800BDC5C(arg0 + 0x190, (ActorAnimationEntry []) sAnimations, 0xF);
                break;
            case 3:
                arg0->unk_3F0 = 0x11;
                func_800BDC5C(arg0 + 0x190, (ActorAnimationEntry []) sAnimations, 0x11);
                break;
            case 4:
                arg0->unk_3F0 = 0x12;
                func_800BDC5C(arg0 + 0x190, (ActorAnimationEntry []) sAnimations, 0x12);
                break;
            case 5:
                arg0->unk_3F0 = 0xA;
                func_800BDC5C(arg0 + 0x190, (ActorAnimationEntry []) sAnimations, 0xA);
                break;
            }
        } else {
            temp_a0_2 = arg0 + 0x190;
            sp24 = temp_a0_2;
            if (func_801378B8(temp_a0_2, arg0->unk_1A0) != 0) {
                temp_v0_2 = arg0->unk_3F0;
                if (temp_v0_2 == 0xF) {
                    arg0->unk_3F0 = 0x10;
                    func_800BDC5C(temp_a0_2, (ActorAnimationEntry []) sAnimations, 0x10);
                } else if (temp_v0_2 == 0x12) {
                    arg0->unk_3F0 = 0x13;
                    func_800BDC5C(temp_a0_2, (ActorAnimationEntry []) sAnimations, 0x13);
                    func_80BA7D14(arg0);
                }
            }
        }
        temp_v0_3 = arg0->unk_3FE;
        if ((temp_v0_3 != 3) && (temp_v0_3 != 4)) {
            if (temp_v0_3 != 5) {

            } else if (func_801378B8(arg0 + 0x190, arg0->unk_1A0) != 0) {
                if ((s32) arg1->csCtx.frames < 0x118) {
                    Audio_PlayActorSound2(arg0, 0x38E4U);
                } else {
                    Audio_PlayActorSound2(arg0, 0x3A62U);
                }
            }
        } else if (func_80BA7D30 == arg0->unk_1D4) {
            func_800B9010(arg0, 0x3265U);
        } else {
            func_800B9010(arg0, 0x3263U);
        }
        func_800EDF24(arg0, arg1, sp2C);
        return 1;
    }
    arg0->unk_3FE = 0x63U;
    return 0;
}

void func_80BA8050(Actor *thisx, GlobalContext *globalCtx) {
    thisx->unk_1D4(globalCtx);
    func_80BA7DC8(thisx, globalCtx);
    SkelAnime_FrameUpdateMatrix(thisx + 0x190);
}
